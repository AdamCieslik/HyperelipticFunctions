
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3. Approach with RiemannTheta package &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=ae36ea3d" />
    <link rel="stylesheet" type="text/css" href="_static/css/.ipynb_checkpoints/custom-checkpoint.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '3. WithRiemmPack';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="2. Genus 2 case" href="2.%20Genus%3D2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="0.%20Intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/wp-logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/wp-logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0.%20Intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.%20Preliminaries.html">1. Preliminaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.%20Genus%3D2.html">2. Genus 2 case</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">3. Approach with RiemannTheta package</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F3. WithRiemmPack.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/3. WithRiemmPack.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Approach with RiemannTheta package</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#riemann-surface">3.1. Riemann surface</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#branch-points">3.2. Branch points</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#first-and-second-kind-periods">3.3. First and Second Kind Periods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#first-kind-periods">3.3.1. First  Kind Periods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#second-kind-periods">3.3.2. Second Kind Periods</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#legendre-relation">3.4. Legendre relation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#characteristics-of-branch-points">3.5. Characteristics of branch points</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#theta-function">3.6. Theta function</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tests">3.6.1. Tests</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sigma-functions">3.7. <span class="math notranslate nohighlight">\(\sigma\)</span>-Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#approximate-definitions">3.7.1. Approximate definitions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">3.7.2. Tests</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#derivatives">3.7.3. Derivatives</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">3.7.3.1. Tests</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wp-functions">3.8. <span class="math notranslate nohighlight">\(\wp\)</span>-Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">3.8.1. Tests</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-relations">3.8.2. Basic relations</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#i">3.8.2.1. I.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ii">3.8.2.2. II.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jacobi-inversion-problem-on-branch-points">3.9. Jacobi inversion problem on branch points</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#divisor">3.9.1. Divisor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">3.9.2. Tests</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bibliography">3.10. Bibliography</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="approach-with-riemanntheta-package">
<h1><span class="section-number">3. </span>Approach with RiemannTheta package<a class="headerlink" href="#approach-with-riemanntheta-package" title="Link to this heading">#</a></h1>
<p>In this approach we use the <i>RiemannTheta</i> package:</p>
<p><a class="reference external" href="https://www.cecm.sfu.ca/~nbruin/RiemannTheta/#riemanntheta">https://www.cecm.sfu.ca/~nbruin/RiemannTheta/#riemanntheta</a></p>
<p>which provides a definition of the Riemann theta function. We will see what effect this has on our results</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.schemes.riemann_surfaces.riemann_surface</span> <span class="kn">import</span> <span class="n">RiemannSurface</span>
<span class="kn">from</span> <span class="nn">riemann_theta.riemann_theta</span> <span class="kn">import</span> <span class="n">RiemannTheta</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Defines the lambda coefficients</span>
<span class="n">lambda0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">lambda2</span> <span class="o">=</span> <span class="mf">12.0</span>
<span class="n">lambda4</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">lambda6</span>  <span class="o">=</span> <span class="mf">0.9</span>
<span class="n">lambda8</span>  <span class="o">=</span> <span class="mf">21.0</span>
<span class="n">lambda10</span>  <span class="o">=</span> <span class="mf">10.0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rational approximation</span>
<span class="n">l0</span> <span class="o">=</span> <span class="n">lambda0</span><span class="o">.</span><span class="n">nearby_rational</span><span class="p">(</span><span class="n">max_error</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>
<span class="n">l2</span> <span class="o">=</span> <span class="n">lambda2</span><span class="o">.</span><span class="n">nearby_rational</span><span class="p">(</span><span class="n">max_error</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>
<span class="n">l4</span> <span class="o">=</span> <span class="n">lambda4</span><span class="o">.</span><span class="n">nearby_rational</span><span class="p">(</span><span class="n">max_error</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>
<span class="n">l6</span> <span class="o">=</span> <span class="n">lambda6</span><span class="o">.</span><span class="n">nearby_rational</span><span class="p">(</span><span class="n">max_error</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>
<span class="n">l8</span> <span class="o">=</span> <span class="n">lambda8</span><span class="o">.</span><span class="n">nearby_rational</span><span class="p">(</span><span class="n">max_error</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>
<span class="n">l10</span> <span class="o">=</span> <span class="n">lambda10</span><span class="o">.</span><span class="n">nearby_rational</span><span class="p">(</span><span class="n">max_error</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Defining the polynomial f</span>
<span class="n">f</span> <span class="o">=</span> <span class="o">-</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">l0</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">l2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">l4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">l6</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">l8</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">l10</span>
</pre></div>
</div>
</div>
</div>
<section id="riemann-surface">
<h2><span class="section-number">3.1. </span>Riemann surface<a class="headerlink" href="#riemann-surface" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">RiemannSurface</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="branch-points">
<h2><span class="section-number">3.2. </span>Branch points<a class="headerlink" href="#branch-points" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_branch_points</span><span class="p">(</span><span class="n">ll0</span><span class="p">,</span> <span class="n">ll2</span><span class="p">,</span> <span class="n">ll4</span><span class="p">,</span> <span class="n">ll6</span><span class="p">,</span> <span class="n">ll8</span><span class="p">,</span> <span class="n">ll10</span><span class="p">):</span>
    <span class="c1"># We define a ring of polynomials over the field of complex numbers</span>
    <span class="n">CC_poly</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">CC</span><span class="p">)</span>
    
    <span class="c1"># We create a polynomial</span>
    <span class="n">pol</span> <span class="o">=</span> <span class="n">ll0</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">ll2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">ll4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">ll6</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ll8</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">ll10</span>
    
    <span class="c1"># We find roots</span>
    <span class="n">roots</span> <span class="o">=</span> <span class="n">pol</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">multiplicities</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="c1"># We add a point at infinity if the degree of the polynomial is odd</span>
    <span class="k">if</span> <span class="n">pol</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">roots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">infinity</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">roots</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example of use:</span>

<span class="n">branch_points</span> <span class="o">=</span> <span class="n">find_branch_points</span><span class="p">(</span><span class="n">l0</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">l4</span><span class="p">,</span> <span class="n">l6</span><span class="p">,</span> <span class="n">l8</span><span class="p">,</span> <span class="n">l10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Branch points:&quot;</span><span class="p">,</span> <span class="n">branch_points</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Branch points: [-11.8251161409669, -1.05264146874943, -0.512317960119317, 0.695037784917798 - 1.04164546422316*I, 0.695037784917798 + 1.04164546422316*I, +Infinity]
</pre></div>
</div>
</div>
</div>
</section>
<section id="first-and-second-kind-periods">
<h2><span class="section-number">3.3. </span>First and Second Kind Periods<a class="headerlink" href="#first-and-second-kind-periods" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">cohomology_basis</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, x]
</pre></div>
</div>
</div>
</div>
<section id="first-kind-periods">
<h3><span class="section-number">3.3.1. </span>First  Kind Periods<a class="headerlink" href="#first-kind-periods" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># holomorphic differentials base</span>
<span class="n">holbais</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MofInt1</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">matrix_of_integral_values</span><span class="p">(</span><span class="n">holbais</span><span class="p">)</span>
<span class="c1"># Let&#39;s display the matrix in a shortened form so that it will be easy to see its structure</span>
<span class="nb">print</span><span class="p">(</span><span class="n">MofInt1</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[     0.13760 - 0.66033*I  -4.9304e-32 - 0.91722*I  -3.9443e-31 + 0.40344*I       1.1746 + 0.25689*I]
[    -0.62448 + 0.28220*I -5.5467e-32 + 0.038862*I  -4.9304e-32 - 0.52554*I      0.14607 + 0.24334*I]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pM</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">period_matrix</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pM</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[   -0.62448 + 0.28220*I 4.3141e-32 + 0.038862*I -4.9304e-32 - 0.52554*I     0.14607 + 0.24334*I]
[    0.13760 - 0.66033*I  2.2187e-31 - 0.91722*I -5.9165e-31 + 0.40344*I      1.1746 + 0.25689*I]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">format_complex</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">):</span>
    <span class="n">real</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">real</span><span class="p">())</span>
    <span class="n">imag</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">imag</span><span class="p">())</span>
    
    <span class="c1"># We round very small values to zero</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">real</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
        <span class="n">real</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">imag</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;0&quot;</span>
        <span class="c1"># We format the result  </span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">imag</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">digits</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">*I&quot;</span>
    
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">imag</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
        <span class="c1"># We format the result</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">real</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">digits</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">sign</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span> <span class="k">if</span> <span class="n">imag</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">real</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">digits</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">sign</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">imag</span><span class="p">)</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">digits</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">*I&quot;</span>


<span class="k">def</span> <span class="nf">ApproxM</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">):</span>
    <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">nrows</span><span class="p">(),</span> <span class="n">matrix</span><span class="o">.</span><span class="n">ncols</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
        <span class="n">formatted_row</span> <span class="o">=</span> <span class="p">[</span><span class="n">format_complex</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span> <span class="n">digits</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">)]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">formatted_row</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ApproxM</span><span class="p">(</span><span class="n">pM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.62448 + 0.28220*I	0.03886*I	-0.52554*I	0.14607 + 0.24334*I
0.13760 - 0.66033*I	-0.91722*I	0.40344*I	1.17459 + 0.25689*I
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ApproxM</span><span class="p">(</span><span class="n">MofInt1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.13760 - 0.66033*I	-0.91722*I	0.40344*I	1.17459 + 0.25689*I
-0.62448 + 0.28220*I	0.03886*I	-0.52554*I	0.14607 + 0.24334*I
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract the omega-periods (first two columns)</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">MofInt1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>

<span class="c1"># Extract the omega&#39;-periods (last two columns)</span>
<span class="n">omegaP</span> <span class="o">=</span> <span class="n">MofInt1</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>

<span class="n">ApproxM</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="n">ApproxM</span><span class="p">(</span><span class="n">omegaP</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.13760 - 0.66033*I	-0.91722*I
-0.62448 + 0.28220*I	0.03886*I

0.40344*I	1.17459 + 0.25689*I
-0.52554*I	0.14607 + 0.24334*I
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tau</span><span class="o">=</span> <span class="n">omega</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span> <span class="o">*</span> <span class="n">omegaP</span>

<span class="c1"># Displaying the result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tau</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-0.28894 + 0.70313*I -0.12636 - 0.46286*I]
[-0.12636 - 0.46286*I  -0.25854 + 1.6328*I]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test of the symmetry</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tau</span><span class="o">-</span><span class="n">tau</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.00000 0.00000]
[0.00000 0.00000]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test of positivity</span>
<span class="c1"># Calculating the complex part of the tau matrix</span>
<span class="n">tauImag</span> <span class="o">=</span> <span class="n">tau</span><span class="o">.</span><span class="n">apply_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">imag</span><span class="p">())</span>

<span class="c1"># Calculate the eigenvalues</span>
<span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">tauImag</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()</span>

<span class="c1"># Checking if all eigenvalues are positive</span>
<span class="n">all_positive</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="n">e</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">eigenvalues</span><span class="p">)</span>

<span class="c1"># Displaying the result</span>
<span class="n">eigenvalues</span><span class="p">,</span> <span class="n">all_positive</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>([1.8239307353738361091933820951, 0.51198440541283078719843599741], True)
</pre></div>
</div>
</div>
</div>
</section>
<section id="second-kind-periods">
<h3><span class="section-number">3.3.2. </span>Second Kind Periods<a class="headerlink" href="#second-kind-periods" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># meromorphic differentials base</span>
<span class="n">merbais</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">l0</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">l2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">l4</span><span class="o">*</span><span class="n">x</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MofInt2</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">matrix_of_integral_values</span><span class="p">(</span><span class="n">merbais</span><span class="p">)</span>
<span class="c1"># Let&#39;s display the matrix in a shortened form so that it will be easy to see its structure</span>
<span class="n">ApproxM</span><span class="p">(</span><span class="n">MofInt2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.15574 + 0.20627*I	0.08372*I	-0.32882*I	-7.07532 + 0.12255*I
4.74867 + 3.09497*I	-0.04832*I	-6.23827*I	-2.96268 + 3.14329*I
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract the omega-periods (first two columns)</span>
<span class="n">eta</span> <span class="o">=</span> <span class="n">MofInt2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>

<span class="c1"># Extract the omega&#39;-periods (last two columns)</span>
<span class="n">etaP</span> <span class="o">=</span> <span class="n">MofInt2</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>

<span class="n">ApproxM</span><span class="p">(</span><span class="n">eta</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="n">ApproxM</span><span class="p">(</span><span class="n">etaP</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.15574 + 0.20627*I	0.08372*I
4.74867 + 3.09497*I	-0.04832*I

-0.32882*I	-7.07532 + 0.12255*I
-6.23827*I	-2.96268 + 3.14329*I
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">omega_inv</span><span class="o">=</span><span class="n">Matrix</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="n">kappa</span> <span class="o">=</span> <span class="n">eta</span><span class="o">*</span><span class="n">omega_inv</span>
<span class="n">ApproxM</span><span class="p">(</span><span class="n">kappa</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.09763 - 0.01261*I	-0.14978 - 0.29754*I
-0.14978 - 0.29754*I	-4.77835 - 7.02263*I
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="legendre-relation">
<h2><span class="section-number">3.4. </span>Legendre relation<a class="headerlink" href="#legendre-relation" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Omega matrix</span>
<span class="n">Omega</span> <span class="o">=</span> <span class="n">block_matrix</span><span class="p">([</span>
    <span class="p">[</span><span class="n">omega</span><span class="p">,</span> <span class="n">omegaP</span><span class="p">],</span>
    <span class="p">[</span><span class="n">eta</span><span class="p">,</span> <span class="n">etaP</span><span class="p">]</span>
<span class="p">])</span>

<span class="c1"># Converting lists to matrices</span>
<span class="n">zeroM</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]])</span>
<span class="n">mOneg</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">]])</span>
<span class="n">Oneg</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>

<span class="c1"># J matrix</span>
<span class="n">J</span> <span class="o">=</span> <span class="n">block_matrix</span><span class="p">([</span>
    <span class="p">[</span><span class="n">zeroM</span><span class="p">,</span> <span class="n">mOneg</span><span class="p">],</span>
    <span class="p">[</span><span class="n">Oneg</span><span class="p">,</span> <span class="n">zeroM</span><span class="p">]</span>
<span class="p">])</span>    


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Omega Matrix:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Omega</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;J Matrix:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Omega Matrix:
[     0.13760 - 0.66033*I  -4.9304e-32 - 0.91722*I| -3.9443e-31 + 0.40344*I       1.1746 + 0.25689*I]
[    -0.62448 + 0.28220*I -5.5467e-32 + 0.038862*I| -4.9304e-32 - 0.52554*I      0.14607 + 0.24334*I]
[-------------------------------------------------+-------------------------------------------------]
[     0.15574 + 0.20627*I  7.8886e-31 + 0.083724*I| -8.3816e-31 - 0.32882*I      -7.0753 + 0.12255*I]
[       4.7487 + 3.0950*I  1.1360e-28 - 0.048319*I|   2.2088e-29 - 6.2383*I       -2.9627 + 3.1433*I]

J Matrix:
[0.00000 0.00000|-1.0000 0.00000]
[0.00000 0.00000|0.00000 -1.0000]
[---------------+---------------]
[ 1.0000 0.00000|0.00000 0.00000]
[0.00000  1.0000|0.00000 0.00000]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">left</span><span class="o">=</span><span class="n">Omega</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">*</span><span class="n">J</span><span class="o">*</span><span class="n">Omega</span>
<span class="n">right</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">J</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">left</span> <span class="o">-</span> <span class="n">right</span>
<span class="n">ApproxM</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0	0	0	0
0	0	0	0
0	0	0	0
0	0	0	0
</pre></div>
</div>
</div>
</div>
</section>
<section id="characteristics-of-branch-points">
<h2><span class="section-number">3.5. </span>Characteristics of branch points<a class="headerlink" href="#characteristics-of-branch-points" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We define the genus variable</span>
<span class="n">genus</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">genus</span>  


<span class="n">eChars</span> <span class="o">=</span> <span class="p">[[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">genus</span><span class="p">)],</span> <span class="p">[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">genus</span><span class="p">)]],</span> 
          <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">genus</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]]</span>

<span class="c1"># Do-like loop in Julia&#39;s Mathematica notebook</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">genus</span><span class="p">):</span>
    <span class="c1"># let&#39;s note the indexing, which must be adjusted by</span>
    <span class="n">eChars</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> 
        <span class="p">[[(</span><span class="n">eChars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">kronecker_delta</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">genus</span> <span class="o">-</span> <span class="n">l</span><span class="p">)</span> <span class="o">+</span> 
           <span class="n">kronecker_delta</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">genus</span> <span class="o">-</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">%</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">genus</span><span class="p">)],</span>
         <span class="p">[(</span><span class="n">eChars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mi">0</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">genus</span><span class="p">)]]</span>
    <span class="p">)</span>

    <span class="n">eChars</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">[[(</span><span class="n">eChars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mi">0</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">genus</span><span class="p">)],</span>
         <span class="p">[(</span><span class="n">eChars</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">kronecker_delta</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">genus</span> <span class="o">-</span> <span class="n">l</span><span class="p">))</span> <span class="o">%</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">genus</span><span class="p">)]]</span>
    <span class="p">)</span>

<span class="c1"># We display matrices</span>
<span class="n">seen_matrices</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">eChars</span><span class="p">)):</span>
    <span class="n">current_matrix</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">eChars</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">current_matrix</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen_matrices</span><span class="p">:</span>
        <span class="n">seen_matrices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_matrix</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">current_matrix</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1 0]
[0 0]

[1 0]
[1 0]

[0 1]
[1 0]

[0 1]
[1 1]

[0 0]
[1 1]

[0 0]
[0 0]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We sum the eChars elements with indices 2*i +1 (because python counts from 0) and take Mod 2</span>
<span class="n">KCh</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="n">eChars</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">genus</span><span class="p">))</span> <span class="o">%</span> <span class="mi">2</span>

<span class="nb">print</span><span class="p">(</span><span class="n">KCh</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1 1]
[0 1]
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the used definition of the RiemannTheta function we need the characteristic encoded in a different form, which is described above.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">encode_characteristic</span><span class="p">(</span><span class="n">KCh</span><span class="p">):</span>
    <span class="c1"># We transform each row into a list</span>
    <span class="n">Rrows</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">Rrow</span><span class="p">)</span> <span class="k">for</span> <span class="n">Rrow</span> <span class="ow">in</span> <span class="n">KCh</span><span class="o">.</span><span class="n">rows</span><span class="p">()]</span>
    <span class="c1"># Number of columns</span>
    <span class="n">Num_col</span> <span class="o">=</span> <span class="n">KCh</span><span class="o">.</span><span class="n">ncols</span><span class="p">()</span>
    
    <span class="c1"># We create coded characteristics</span>
    <span class="n">characteristics</span> <span class="o">=</span> <span class="n">Rrows</span> <span class="o">+</span> <span class="p">[</span><span class="n">Num_col</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">characteristics</span>

<span class="c1"># Przykładowe użycie</span>
<span class="n">KChl</span> <span class="o">=</span> <span class="n">encode_characteristic</span><span class="p">(</span><span class="n">KCh</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">KChl</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1, 1], [0, 1], 2]
</pre></div>
</div>
</div>
</div>
</section>
<section id="theta-function">
<h2><span class="section-number">3.6. </span>Theta function<a class="headerlink" href="#theta-function" title="Link to this heading">#</a></h2>
<p><a class="reference internal" href="2.%20Genus%3D2.html#theta_df">Definition 2.2</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Evaluate Riemann theta function with characteristic and derivatives.</p>
<p><code class="docutils literal notranslate"><span class="pre">INPUT</span></code>: - z – vector; optional (default 0). Point to evaluate theta function at. - <code class="docutils literal notranslate"><span class="pre">char</span></code> – list or vector; optional (default 0). Characteristic.</p>
<p>The characteristic can either be specified as a list <code class="docutils literal notranslate"><span class="pre">[[eps_1,</span> <span class="pre">...,eps_g],[delta_1,</span> <span class="pre">...,</span> <span class="pre">delta_g],N]</span></code>, where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the level of the characteristic and the <code class="docutils literal notranslate"><span class="pre">eps_i,</span> <span class="pre">delta_j</span></code> are integers describing the characteristic, or as a <code class="docutils literal notranslate"><span class="pre">2*g`-dimensional</span> <span class="pre">vector</span> <span class="pre">over</span> <span class="pre">``ZZ/</span> <span class="pre">N*ZZ</span></code>. In the latter case, the level N is read off from the base ring and the vector is taken to be <code class="docutils literal notranslate"><span class="pre">[eps_1,</span> <span class="pre">...,</span> <span class="pre">eps_g,</span> <span class="pre">delta_1,</span> <span class="pre">...,</span> <span class="pre">delta_g]</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">derivs</span></code> – list; optional (default []). Derivatives. It can be a list
of integers <code class="docutils literal notranslate"><span class="pre">[i_1,...,i_n]</span></code>, in which case it is taken to mean the derivative of order <code class="docutils literal notranslate"><span class="pre">n</span></code>, obtained by taking the partial derivative with respect to z<code class="docutils literal notranslate"><span class="pre">[i_1],</span> <span class="pre">...,</span> <span class="pre">z[i_n]</span></code>. Alternatively, it can be a list of lists of integers, in which case the values of the derivatives indicated by the members of the list are returned as a tuple, in order.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tol</span></code> – real number; optional. Tolerance allowed in approximation. The default is
the tolerance indicated by the precision of the base ring. Note that the tolerance controlled is the tolerance in the approximation of the periodic part of the Riemann Theta function (see [DHBvHS2004]). Furthermore, floating point rounding in iterated summations may perturb the lower bits.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">OUTPUT</span></code>: A complex number of a tuple of them; the value(s) of the indicated Riemann Theta function(s).</p>
<p><code class="docutils literal notranslate"><span class="pre">EXAMPLE</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="p">:</span> <span class="kn">from</span> <span class="nn">riemann_theta.riemann_theta</span> <span class="kn">import</span> <span class="n">RiemannTheta</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">RT</span><span class="o">=</span><span class="n">RiemannTheta</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="n">CC</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">I</span><span class="p">]))</span>
<span class="n">sage</span><span class="p">:</span> <span class="n">RT</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">char</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mi">2</span><span class="p">],</span><span class="n">derivs</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="c1"># abs_tol = 1e-15</span>
<span class="mf">2.88494706892332e-16</span>
</pre></div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tautest</span><span class="o">=</span><span class="n">matrix</span><span class="p">(</span><span class="n">CC</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">I</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">I</span><span class="p">])</span>
<span class="n">RT</span><span class="o">=</span><span class="n">RiemannTheta</span><span class="p">(</span><span class="n">tautest</span><span class="p">)</span>
<span class="n">RT</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">char</span><span class="o">=</span><span class="p">[[</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.18034044830161 + 5.90898167305014e-22*I
</pre></div>
</div>
</div>
</div>
<section id="tests">
<h3><span class="section-number">3.6.1. </span>Tests<a class="headerlink" href="#tests" title="Link to this heading">#</a></h3>
<p>Test of the formula (<span id="id1">[<a class="reference internal" href="#id13" title="Julia Bernatska. Computation of \$\wp\$-functions on plane algebraic curves. July 2024. URL: https://arxiv.org/abs/2407.05632v3 (visited on 2024-10-17).">1</a>]</span>, p.4, eq. 7)</p>
<div class="math notranslate nohighlight">
\[\theta[\varepsilon](\mathbf{v};\tau) = 
            e^{i\pi\left(\frac{1}{2} \mathbf{\varepsilon}'^T\right) \tau \left(\frac{1}{2} \mathbf{\varepsilon}'\right) + 2i\pi \left( \mathbf{v} + \frac{1}{2} \mathbf{\varepsilon}\right)^T \left(\frac{1}{2} \mathbf{\varepsilon}'\right)} \theta\left(\mathbf{v} + \frac{1}{2}\mathbf{\varepsilon} + \tau\left(\frac{1}{2}\mathbf{\varepsilon}'\right);\tau \right).   \]</div>
<p>where a characteristic is a a <span class="math notranslate nohighlight">\(2\times g\)</span> matrix <span class="math notranslate nohighlight">\([\varepsilon] =(\mathbf{\varepsilon}',\mathbf{\varepsilon})^T \)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the genus</span>
<span class="n">g</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># For genus 2</span>

<span class="c1"># Define the period matrix tau</span>
<span class="c1">### tau = Matrix(CC, [[I, 0.5], [0.5, I]])</span>
<span class="n">tau</span> <span class="o">=</span> <span class="n">omega</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span> <span class="o">*</span> <span class="n">omegaP</span>

<span class="c1"># Define the vector v</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">CC</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>

<span class="c1"># Define the characteristic</span>
<span class="n">eps_prime</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">eps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Level of the characteristic</span>
<span class="n">char</span> <span class="o">=</span> <span class="p">[</span><span class="n">eps_prime</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">N</span><span class="p">]</span>

<span class="c1"># Create an instance of RiemannTheta with the period matrix tau</span>
<span class="n">RT</span> <span class="o">=</span> <span class="n">RiemannTheta</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span>

<span class="c1"># Compute theta with characteristic at v</span>
<span class="n">theta_char</span> <span class="o">=</span> <span class="n">RT</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">char</span><span class="o">=</span><span class="n">char</span><span class="p">)</span>

<span class="c1"># Compute half of the characteristic vectors</span>
<span class="n">eps_vec</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">CC</span><span class="p">,</span> <span class="n">eps</span><span class="p">)</span>
<span class="n">eps_prime_vec</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">CC</span><span class="p">,</span> <span class="n">eps_prime</span><span class="p">)</span>
<span class="n">eps_half</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">eps_vec</span>
<span class="n">eps_prime_half</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">eps_prime_vec</span>

<span class="c1"># Compute the shifted vector v_shifted</span>
<span class="n">v_shifted</span> <span class="o">=</span> <span class="n">v</span> <span class="o">+</span> <span class="n">eps_half</span> <span class="o">+</span> <span class="n">tau</span> <span class="o">*</span> <span class="n">eps_prime_half</span>

<span class="c1"># Compute the terms for the exponential factor</span>
<span class="n">term1</span> <span class="o">=</span> <span class="p">(</span><span class="n">eps_prime_half</span><span class="p">)</span> <span class="o">*</span> <span class="n">tau</span> <span class="o">*</span> <span class="p">(</span><span class="n">eps_prime_half</span><span class="p">)</span>
<span class="n">term2</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="n">eps_half</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">eps_prime_half</span><span class="p">)</span>

<span class="c1"># Compute the exponential factor</span>
<span class="n">exp_factor</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">I</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">term1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">I</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">term2</span><span class="p">)</span>

<span class="c1"># Compute theta at the shifted point without characteristic</span>
<span class="n">theta_standard</span> <span class="o">=</span> <span class="n">RT</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">v_shifted</span><span class="p">)</span>

<span class="c1"># Compute the RHS of the relation</span>
<span class="n">RHS</span> <span class="o">=</span> <span class="n">exp_factor</span> <span class="o">*</span> <span class="n">theta_standard</span>

<span class="c1"># Compute the difference</span>
<span class="n">difference</span> <span class="o">=</span> <span class="n">theta_char</span> <span class="o">-</span> <span class="n">RHS</span>

<span class="c1"># Print the results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Theta with characteristic:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">theta_char</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exponential factor:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">exp_factor</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Theta at shifted point:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">theta_standard</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RHS:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">RHS</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Difference:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">difference</span><span class="p">)</span>

<span class="c1"># Check if the difference is within an acceptable tolerance</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="mf">1e-12</span>  <span class="c1"># Adjust based on the precision</span>
<span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">difference</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tolerance</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The relation is verified within the given tolerance.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The relation is not satisfied within the given tolerance.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Theta with characteristic:
 1.0600858517074843513006428717 - 0.25010237312126239117384680391*I

Exponential factor:
 0.5734712442681018 + 0.050148801540618036*I

Theta at shifted point:
 1.7966652347912196331751812601 - 0.59323459513636576276197467044*I

RHS:
 1.0600858517074845 - 0.25010237312126254*I

Difference:
 -2.220446049250313e-16 + 1.6653345369377348e-16*I
The relation is verified within the given tolerance.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="sigma-functions">
<h2><span class="section-number">3.7. </span><span class="math notranslate nohighlight">\(\sigma\)</span>-Functions<a class="headerlink" href="#sigma-functions" title="Link to this heading">#</a></h2>
<p><a class="reference internal" href="2.%20Genus%3D2.html#sigma_df">Definition 2.3</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We define variables</span>
<span class="n">var</span><span class="p">(</span><span class="s1">&#39;U1 U3&#39;</span><span class="p">)</span>


<span class="c1"># sigma</span>
<span class="k">def</span> <span class="nf">Tsigma</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">):</span>
    <span class="n">vec</span><span class="o">=</span><span class="n">omega_inv</span> <span class="o">*</span> <span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])</span>
    <span class="n">RTtem</span><span class="o">=</span><span class="n">RiemannTheta</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])</span><span class="o">*</span><span class="n">kappa</span><span class="o">*</span><span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])))</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">RTtem</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">vec</span><span class="p">,</span><span class="n">char</span><span class="o">=</span><span class="n">KChl</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">e</span><span class="o">*</span><span class="n">theta</span>

<span class="c1"># C constant</span>
<span class="n">det_omega</span> <span class="o">=</span> <span class="n">omega</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="n">g</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1">#Branch points</span>
<span class="n">BP</span> <span class="o">=</span> <span class="n">find_branch_points</span><span class="p">(</span><span class="n">l0</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">l4</span><span class="p">,</span> <span class="n">l6</span><span class="p">,</span> <span class="n">l8</span><span class="p">,</span> <span class="n">l10</span><span class="p">)</span>
<span class="c1"># Calculating the product of branch point differences</span>
<span class="n">prod</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">BP</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">BP</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">BP</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">infinity</span> <span class="ow">and</span> <span class="n">BP</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="n">infinity</span><span class="p">:</span>
            <span class="n">prod</span> <span class="o">*=</span> <span class="p">(</span><span class="n">BP</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">BP</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="o">**</span><span class="n">g</span> <span class="o">/</span> <span class="n">det_omega</span><span class="p">)</span> <span class="o">*</span> <span class="n">prod</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Constant C another definition</span>
<span class="n">det2_omega</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">omega</span><span class="o">.</span><span class="n">determinant</span><span class="p">())</span>

<span class="n">C2</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="o">**</span><span class="n">g</span> <span class="o">/</span> <span class="n">det2_omega</span><span class="p">)</span> <span class="o">*</span> <span class="n">prod</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Taking into account the factor (2*pi*i)^g</span>
<span class="n">C3</span> <span class="o">=</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">I</span><span class="p">)</span><span class="o">**</span><span class="n">g</span> <span class="o">/</span> <span class="n">det2_omega</span><span class="p">)</span> <span class="o">*</span> <span class="n">prod</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">sigma</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">C</span><span class="o">*</span><span class="n">Tsigma</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="approximate-definitions">
<h3><span class="section-number">3.7.1. </span>Approximate definitions<a class="headerlink" href="#approximate-definitions" title="Link to this heading">#</a></h3>
<p><a class="reference internal" href="2.%20Genus%3D2.html#sigma_app1_df">Definition 2.4</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sigmaApp1</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">U3</span> 
              <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">U1</span><span class="o">**</span><span class="mi">3</span> 
              <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="n">l6</span> <span class="o">*</span> <span class="n">U3</span><span class="o">**</span><span class="mi">3</span> 
              <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span> <span class="o">*</span> <span class="n">l4</span> <span class="o">*</span> <span class="n">U1</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="n">U3</span> 
              <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="n">l6</span> <span class="o">*</span> <span class="n">U1</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">U3</span><span class="o">**</span><span class="mi">2</span>
              <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="n">l8</span> <span class="o">*</span> <span class="n">U1</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">U3</span><span class="o">**</span><span class="mi">3</span> 
              <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">l10</span> <span class="o">*</span> <span class="n">U1</span> <span class="o">*</span> <span class="n">U3</span><span class="o">**</span><span class="mi">4</span> 
              <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">60</span><span class="p">)</span> <span class="o">*</span> <span class="n">l4</span> <span class="o">*</span> <span class="n">l8</span> <span class="o">*</span> <span class="n">U3</span><span class="o">**</span><span class="mi">5</span> 
              <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">120</span><span class="p">)</span> <span class="o">*</span> <span class="n">l6</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">U3</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference internal" href="2.%20Genus%3D2.html#sigma_app2_df">Definition 2.5</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sigmaApp2</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">U3</span> 
              <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">U1</span><span class="o">**</span><span class="mi">3</span> 
              <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="n">l6</span> <span class="o">*</span> <span class="n">U3</span><span class="o">**</span><span class="mi">3</span> 
              <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span> <span class="o">*</span> <span class="n">l4</span> <span class="o">*</span> <span class="n">U1</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="n">U3</span> 
              <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="n">l6</span> <span class="o">*</span> <span class="n">U1</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">U3</span><span class="o">**</span><span class="mi">2</span>
              <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="n">l8</span> <span class="o">*</span> <span class="n">U1</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">U3</span><span class="o">**</span><span class="mi">3</span> 
              <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">l10</span> <span class="o">*</span> <span class="n">U1</span> <span class="o">*</span> <span class="n">U3</span><span class="o">**</span><span class="mi">4</span> 
              <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">60</span><span class="p">)</span> <span class="o">*</span> <span class="n">l4</span> <span class="o">*</span> <span class="n">l8</span> <span class="o">*</span> <span class="n">U3</span><span class="o">**</span><span class="mi">5</span> 
              <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">120</span><span class="p">)</span> <span class="o">*</span> <span class="n">l6</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">U3</span><span class="o">**</span><span class="mi">5</span>
              <span class="o">-</span> <span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="o">*</span> <span class="n">l4</span> <span class="o">*</span> <span class="n">U1</span><span class="o">**</span><span class="mi">7</span>
              <span class="o">+</span> <span class="p">(</span><span class="mi">64</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="o">*</span> <span class="n">l6</span> <span class="o">*</span> <span class="n">U1</span><span class="o">**</span><span class="mi">9</span>
              <span class="o">-</span> <span class="p">(</span><span class="mi">8</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="o">*</span> <span class="n">l6</span> <span class="o">*</span> <span class="n">U3</span> <span class="o">*</span> <span class="n">U1</span><span class="o">**</span><span class="mi">6</span>
              <span class="o">+</span> <span class="p">(</span><span class="mi">1600</span> <span class="o">*</span> <span class="n">l8</span> <span class="o">-</span> <span class="mi">408</span> <span class="o">*</span> <span class="n">l4</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span> <span class="o">*</span> <span class="n">U1</span><span class="o">**</span><span class="mi">11</span>
              <span class="o">-</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">l4</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">32</span> <span class="o">*</span> <span class="n">l8</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="o">*</span> <span class="n">U3</span> <span class="o">*</span> <span class="n">U1</span><span class="o">**</span><span class="mi">8</span>
              <span class="o">-</span> <span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="o">*</span> <span class="n">l8</span> <span class="o">*</span> <span class="n">U3</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">U1</span><span class="o">**</span><span class="mi">5</span>
             <span class="p">)</span>
    
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference internal" href="2.%20Genus%3D2.html#sigma_app3_df">Definition 2.6</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sigmaApp3</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">U1</span> 
              <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">U3</span><span class="o">**</span><span class="mi">3</span> 
              <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="p">)</span> <span class="o">*</span> <span class="n">l6</span> <span class="o">*</span> <span class="n">U1</span><span class="o">**</span><span class="mi">3</span>
             <span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference internal" href="2.%20Genus%3D2.html#sigma_app4_df">Definition 2.7</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sigmaApp4</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">U1</span> 
              <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">24</span><span class="p">)</span> <span class="o">*</span> <span class="n">l6</span> <span class="o">*</span> <span class="n">U1</span><span class="o">**</span><span class="mi">3</span>
              <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">13</span><span class="p">)</span> <span class="o">*</span> <span class="n">l0</span> <span class="o">*</span> <span class="n">U3</span><span class="o">**</span><span class="mi">3</span> 
             <span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h3><span class="section-number">3.7.2. </span>Tests<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u1</span><span class="o">=</span><span class="mf">2.21231</span>
<span class="n">u3</span><span class="o">=</span><span class="mf">7.32112</span>

<span class="n">k1</span><span class="o">=</span><span class="mf">8.8976</span>
<span class="n">k3</span><span class="o">=</span><span class="mf">5.2315</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="mi">10</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>

<span class="n">testS</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">u3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">sigma</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">k3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
<span class="n">testSApp1</span> <span class="o">=</span> <span class="n">sigmaApp1</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">u3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">sigmaApp1</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">k3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
<span class="n">testSApp2</span> <span class="o">=</span> <span class="n">sigmaApp2</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">u3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">sigmaApp2</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">k3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
<span class="n">testSApp3</span> <span class="o">=</span> <span class="n">sigmaApp3</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">u3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">sigmaApp3</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">k3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
<span class="n">testSApp4</span> <span class="o">=</span> <span class="n">sigmaApp4</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">u3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">sigmaApp4</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">k3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result for comparison with sigmaApp1:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testS</span><span class="o">-</span><span class="n">testSApp1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result for comparison with sigmaApp2:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testS</span><span class="o">-</span><span class="n">testSApp2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result for comparison with sigmaApp3:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testS</span><span class="o">-</span><span class="n">testSApp3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result for comparison with sigmaApp4:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testS</span><span class="o">-</span><span class="n">testSApp4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Difference between sigmaApp1 and sigmaApp3:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testSApp1</span><span class="o">-</span><span class="n">testSApp3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result for comparison with sigmaApp1:
-0.918639409348415 - 1.11022302462516e-16*I

Result for comparison with sigmaApp2:
-0.918639706374917 - 1.11022302462516e-16*I

Result for comparison with sigmaApp3:
0.240503143950716 - 1.11022302462516e-16*I

Result for comparison with sigmaApp4:
0.239474509747872 - 1.11022302462516e-16*I

Difference between sigmaApp1 and sigmaApp3:
1.15914255329913
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="mi">10</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>

<span class="n">testS</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">u3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">sigma</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">k3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
<span class="n">testSApp1</span> <span class="o">=</span> <span class="n">sigmaApp1</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">u3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">sigmaApp1</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">k3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
<span class="n">testSApp2</span> <span class="o">=</span> <span class="n">sigmaApp2</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">u3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">sigmaApp2</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">k3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
<span class="n">testSApp3</span> <span class="o">=</span> <span class="n">sigmaApp3</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">u3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">sigmaApp3</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">k3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
<span class="n">testSApp4</span> <span class="o">=</span> <span class="n">sigmaApp4</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">u3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">sigmaApp4</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">k3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result for comparison with sigmaApp1:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testS</span><span class="o">-</span><span class="n">testSApp1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result for comparison with sigmaApp2:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testS</span><span class="o">-</span><span class="n">testSApp2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result for comparison with sigmaApp3:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testS</span><span class="o">-</span><span class="n">testSApp3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result for comparison with sigmaApp4:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testS</span><span class="o">-</span><span class="n">testSApp4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Difference between sigmaApp1 and sigmaApp3:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testSApp1</span><span class="o">-</span><span class="n">testSApp3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result for comparison with sigmaApp1:
-0.884388199106278 + 9.45354905468321e-14*I

Result for comparison with sigmaApp2:
-0.884388199106278 + 9.45354905468321e-14*I

Result for comparison with sigmaApp3:
0.266400976142481 + 9.45354905468321e-14*I

Result for comparison with sigmaApp4:
0.266400975114249 + 9.45354905468321e-14*I

Difference between sigmaApp1 and sigmaApp3:
1.15078917524876
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="mi">10</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>

<span class="n">testS</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">u3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">sigma</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">k3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
<span class="n">testSApp1</span> <span class="o">=</span> <span class="n">sigmaApp1</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">u3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">sigmaApp1</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">k3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
<span class="n">testSApp2</span> <span class="o">=</span> <span class="n">sigmaApp2</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">u3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">sigmaApp2</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">k3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
<span class="n">testSApp3</span> <span class="o">=</span> <span class="n">sigmaApp3</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">u3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">sigmaApp3</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">k3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
<span class="n">testSApp4</span> <span class="o">=</span> <span class="n">sigmaApp4</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">u3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">sigmaApp4</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">k3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result for comparison with sigmaApp1:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testS</span><span class="o">-</span><span class="n">testSApp1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result for comparison with sigmaApp2:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testS</span><span class="o">-</span><span class="n">testSApp2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result for comparison with sigmaApp3:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testS</span><span class="o">-</span><span class="n">testSApp3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result for comparison with sigmaApp4:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testS</span><span class="o">-</span><span class="n">testSApp4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Difference between sigmaApp1 and sigmaApp3:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testSApp1</span><span class="o">-</span><span class="n">testSApp3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result for comparison with sigmaApp1:
-0.884388164535101 - 2.32167818303708e-9*I

Result for comparison with sigmaApp2:
-0.884388164535101 - 2.32167818303708e-9*I

Result for comparison with sigmaApp3:
0.266401002545177 - 2.32167818303708e-9*I

Result for comparison with sigmaApp4:
0.266401002545177 - 2.32167818303708e-9*I

Difference between sigmaApp1 and sigmaApp3:
1.15078916708028
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="mi">10</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">)</span>

<span class="n">testS</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">u3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">sigma</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">k3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
<span class="n">testSApp1</span> <span class="o">=</span> <span class="n">sigmaApp1</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">u3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">sigmaApp1</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">k3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
<span class="n">testSApp2</span> <span class="o">=</span> <span class="n">sigmaApp2</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">u3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">sigmaApp2</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">k3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
<span class="n">testSApp3</span> <span class="o">=</span> <span class="n">sigmaApp3</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">u3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">sigmaApp3</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">k3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
<span class="n">testSApp4</span> <span class="o">=</span> <span class="n">sigmaApp4</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">u3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">sigmaApp4</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">d</span><span class="p">,</span><span class="n">k3</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result for comparison with sigmaApp1:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testS</span><span class="o">-</span><span class="n">testSApp1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result for comparison with sigmaApp2:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testS</span><span class="o">-</span><span class="n">testSApp2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result for comparison with sigmaApp3:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testS</span><span class="o">-</span><span class="n">testSApp3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result for comparison with sigmaApp4:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testS</span><span class="o">-</span><span class="n">testSApp4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Difference between sigmaApp1 and sigmaApp3:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">testSApp1</span><span class="o">-</span><span class="n">testSApp3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result for comparison with sigmaApp1:
-0.884387983476935 - 0.00167405920267910*I

Result for comparison with sigmaApp2:
-0.884387983476935 - 0.00167405920267910*I

Result for comparison with sigmaApp3:
0.266401183603342 - 0.00167405920267910*I

Result for comparison with sigmaApp4:
0.266401183603342 - 0.00167405920267910*I

Difference between sigmaApp1 and sigmaApp3:
1.15078916708028
</pre></div>
</div>
</div>
</div>
<div class="proof observation admonition" id="observation-0">
<p class="admonition-title"><span class="caption-number">Observation 3.1 </span></p>
<section class="observation-content" id="proof-content">
<p>Using the Riemann Theta package gives much better approximations than the explicit old definition</p>
</section>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#The C constant test based on the first two approximations</span>

<span class="n">u1</span><span class="o">=</span><span class="mi">10</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
<span class="n">u3</span><span class="o">=</span><span class="mf">0.0012131</span>

<span class="n">Capp</span><span class="o">=</span><span class="n">u3</span><span class="o">/</span><span class="n">Tsigma</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;C from definition:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;C2 from definition:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">C2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;C3 from definition:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">C3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Approximate C:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Capp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C from definition:
0.141841687815806 + 0.538908396778394*I

C2 from definition:
0.526634148916357 + 0.182202628180384*I

C3 from definition:
-0.36440525636076754 + 1.0532682978327146*I

Approximate C:
-0.394449548035152 + 0.592130183781763*I
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#The C constant test based on the last two approximations</span>

<span class="n">u3</span><span class="o">=</span><span class="mi">10</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
<span class="n">u1</span><span class="o">=</span><span class="mf">0.0012131</span>

<span class="n">Capp</span><span class="o">=</span><span class="n">u1</span><span class="o">/</span><span class="n">Tsigma</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;C from definition:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;C2 from definition:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">C2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;C3 from definition:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">C3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Approximate C:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Capp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C from definition:
0.141841687815806 + 0.538908396778394*I

C2 from definition:
0.526634148916357 + 0.182202628180384*I

C3 from definition:
-0.36440525636076754 + 1.0532682978327146*I

Approximate C:
-0.202079378743055 + 0.303352609401302*I
</pre></div>
</div>
</div>
</div>
</section>
<section id="derivatives">
<h3><span class="section-number">3.7.3. </span>Derivatives<a class="headerlink" href="#derivatives" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first derivative of sigma over U1</span>
<span class="k">def</span> <span class="nf">Tsigma1</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">):</span>
    <span class="n">vec</span><span class="o">=</span><span class="n">omega_inv</span> <span class="o">*</span> <span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])</span>
    <span class="n">RTtem</span><span class="o">=</span><span class="n">RiemannTheta</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])</span><span class="o">*</span><span class="n">kappa</span><span class="o">*</span><span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])))</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">RTtem</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">vec</span><span class="p">,</span><span class="n">char</span><span class="o">=</span><span class="n">KChl</span><span class="p">,</span><span class="n">derivs</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">e</span><span class="o">*</span><span class="n">theta</span>

<span class="c1"># second derivative of sigma over U1</span>
<span class="k">def</span> <span class="nf">Tsigma11</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">):</span>
    <span class="n">vec</span><span class="o">=</span><span class="n">omega_inv</span> <span class="o">*</span> <span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])</span>
    <span class="n">RTtem</span><span class="o">=</span><span class="n">RiemannTheta</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])</span><span class="o">*</span><span class="n">kappa</span><span class="o">*</span><span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])))</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">RTtem</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">vec</span><span class="p">,</span><span class="n">char</span><span class="o">=</span><span class="n">KChl</span><span class="p">,</span><span class="n">derivs</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">e</span><span class="o">*</span><span class="n">theta</span>

<span class="c1"># derivative of sigma over U1 and U3</span>
<span class="k">def</span> <span class="nf">Tsigma13</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">):</span>
    <span class="n">vec</span><span class="o">=</span><span class="n">omega_inv</span> <span class="o">*</span> <span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])</span>
    <span class="n">RTtem</span><span class="o">=</span><span class="n">RiemannTheta</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])</span><span class="o">*</span><span class="n">kappa</span><span class="o">*</span><span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])))</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">RTtem</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">vec</span><span class="p">,</span><span class="n">char</span><span class="o">=</span><span class="n">KChl</span><span class="p">,</span><span class="n">derivs</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">e</span><span class="o">*</span><span class="n">theta</span>

<span class="c1"># first derivative of sigma over U3</span>
<span class="k">def</span> <span class="nf">Tsigma3</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">):</span>
    <span class="n">vec</span><span class="o">=</span><span class="n">omega_inv</span> <span class="o">*</span> <span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])</span>
    <span class="n">RTtem</span><span class="o">=</span><span class="n">RiemannTheta</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])</span><span class="o">*</span><span class="n">kappa</span><span class="o">*</span><span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])))</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">RTtem</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">vec</span><span class="p">,</span><span class="n">char</span><span class="o">=</span><span class="n">KChl</span><span class="p">,</span><span class="n">derivs</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">e</span><span class="o">*</span><span class="n">theta</span>

<span class="c1"># second derivative of sigma over U3</span>
<span class="k">def</span> <span class="nf">Tsigma33</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">):</span>
    <span class="n">vec</span><span class="o">=</span><span class="n">omega_inv</span> <span class="o">*</span> <span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])</span>
    <span class="n">RTtem</span><span class="o">=</span><span class="n">RiemannTheta</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])</span><span class="o">*</span><span class="n">kappa</span><span class="o">*</span><span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])))</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">RTtem</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">vec</span><span class="p">,</span><span class="n">char</span><span class="o">=</span><span class="n">KChl</span><span class="p">,</span><span class="n">derivs</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">e</span><span class="o">*</span><span class="n">theta</span>

<span class="c1"># third derivative of sigma over U3</span>
<span class="k">def</span> <span class="nf">Tsigma333</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">):</span>
    <span class="n">vec</span><span class="o">=</span><span class="n">omega_inv</span> <span class="o">*</span> <span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])</span>
    <span class="n">RTtem</span><span class="o">=</span><span class="n">RiemannTheta</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])</span><span class="o">*</span><span class="n">kappa</span><span class="o">*</span><span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])))</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">RTtem</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">vec</span><span class="p">,</span><span class="n">char</span><span class="o">=</span><span class="n">KChl</span><span class="p">,</span><span class="n">derivs</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">e</span><span class="o">*</span><span class="n">theta</span>

<span class="c1"># fourth derivative of sigma over U3</span>
<span class="k">def</span> <span class="nf">Tsigma3333</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">):</span>
    <span class="n">vec</span><span class="o">=</span><span class="n">omega_inv</span> <span class="o">*</span> <span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])</span>
    <span class="n">RTtem</span><span class="o">=</span><span class="n">RiemannTheta</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])</span><span class="o">*</span><span class="n">kappa</span><span class="o">*</span><span class="n">vector</span><span class="p">([</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">])))</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">RTtem</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">vec</span><span class="p">,</span><span class="n">char</span><span class="o">=</span><span class="n">KChl</span><span class="p">,</span><span class="n">derivs</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">e</span><span class="o">*</span><span class="n">theta</span>
</pre></div>
</div>
</div>
</div>
<section id="id3">
<h4><span class="section-number">3.7.3.1. </span>Tests<a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Approx deriv. </span>
<span class="c1"># We define variables</span>
<span class="n">var</span><span class="p">(</span><span class="s1">&#39;U1 U3&#39;</span><span class="p">)</span>

<span class="c1"># sigma1</span>
<span class="k">def</span> <span class="nf">sigma1App1</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">symbolic_expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sigmaApp1</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">),</span> <span class="n">U1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">symbolic_expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">U1</span><span class="p">:</span> <span class="n">u1_val</span><span class="p">,</span> <span class="n">U3</span><span class="p">:</span> <span class="n">u3_val</span><span class="p">})</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>
<span class="c1"># sigma11</span>
<span class="k">def</span> <span class="nf">sigma11App1</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">symbolic_expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sigmaApp1</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">),</span> <span class="n">U1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbolic_expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">U1</span><span class="p">:</span> <span class="n">u1_val</span><span class="p">,</span> <span class="n">U3</span><span class="p">:</span> <span class="n">u3_val</span><span class="p">})</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>    

<span class="c1"># sigma3</span>
<span class="k">def</span> <span class="nf">sigma3App1</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">symbolic_expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sigmaApp1</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">),</span> <span class="n">U3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbolic_expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">U1</span><span class="p">:</span> <span class="n">u1_val</span><span class="p">,</span> <span class="n">U3</span><span class="p">:</span> <span class="n">u3_val</span><span class="p">})</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>

<span class="c1"># sigma13</span>
<span class="k">def</span> <span class="nf">sigma13App1</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">symbolic_expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sigmaApp1</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">),</span> <span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbolic_expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">U1</span><span class="p">:</span> <span class="n">u1_val</span><span class="p">,</span> <span class="n">U3</span><span class="p">:</span> <span class="n">u3_val</span><span class="p">})</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>  

<span class="c1"># sigma33</span>
<span class="k">def</span> <span class="nf">sigma33App1</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">symbolic_expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sigmaApp1</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">),</span> <span class="n">U3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbolic_expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">U1</span><span class="p">:</span> <span class="n">u1_val</span><span class="p">,</span> <span class="n">U3</span><span class="p">:</span> <span class="n">u3_val</span><span class="p">})</span><span class="o">.</span><span class="n">n</span><span class="p">()</span> 

<span class="c1"># Second App formula</span>
<span class="c1"># sigma1</span>
<span class="k">def</span> <span class="nf">sigma1App2</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">symbolic_expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sigmaApp2</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">),</span> <span class="n">U1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbolic_expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">U1</span><span class="p">:</span> <span class="n">u1_val</span><span class="p">,</span> <span class="n">U3</span><span class="p">:</span> <span class="n">u3_val</span><span class="p">})</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>

<span class="c1"># sigma11</span>
<span class="k">def</span> <span class="nf">sigma11App2</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">symbolic_expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sigmaApp2</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">),</span> <span class="n">U1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbolic_expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">U1</span><span class="p">:</span> <span class="n">u1_val</span><span class="p">,</span> <span class="n">U3</span><span class="p">:</span> <span class="n">u3_val</span><span class="p">})</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>

<span class="c1"># sigma3</span>
<span class="k">def</span> <span class="nf">sigma3App2</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">symbolic_expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sigmaApp2</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">),</span> <span class="n">U3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbolic_expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">U1</span><span class="p">:</span> <span class="n">u1_val</span><span class="p">,</span> <span class="n">U3</span><span class="p">:</span> <span class="n">u3_val</span><span class="p">})</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>

<span class="c1"># sigma13</span>
<span class="k">def</span> <span class="nf">sigma13App2</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">symbolic_expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sigmaApp2</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">),</span> <span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbolic_expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">U1</span><span class="p">:</span> <span class="n">u1_val</span><span class="p">,</span> <span class="n">U3</span><span class="p">:</span> <span class="n">u3_val</span><span class="p">})</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>

<span class="c1"># sigma33</span>
<span class="k">def</span> <span class="nf">sigma33App2</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">symbolic_expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sigmaApp2</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">),</span> <span class="n">U3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbolic_expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">U1</span><span class="p">:</span> <span class="n">u1_val</span><span class="p">,</span> <span class="n">U3</span><span class="p">:</span> <span class="n">u3_val</span><span class="p">})</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>

<span class="c1"># Third App formula</span>
<span class="c1"># sigma1</span>
<span class="k">def</span> <span class="nf">sigma1App3</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">symbolic_expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sigmaApp3</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">),</span> <span class="n">U1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbolic_expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">U1</span><span class="p">:</span> <span class="n">u1_val</span><span class="p">,</span> <span class="n">U3</span><span class="p">:</span> <span class="n">u3_val</span><span class="p">})</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>

<span class="c1"># sigma11</span>
<span class="k">def</span> <span class="nf">sigma11App3</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">symbolic_expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sigmaApp3</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">),</span> <span class="n">U1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbolic_expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">U1</span><span class="p">:</span> <span class="n">u1_val</span><span class="p">,</span> <span class="n">U3</span><span class="p">:</span> <span class="n">u3_val</span><span class="p">})</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>

<span class="c1"># sigma13</span>
<span class="k">def</span> <span class="nf">sigma13App3</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">symbolic_expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sigmaApp3</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">),</span> <span class="n">U1</span><span class="p">,</span><span class="n">U3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbolic_expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">U1</span><span class="p">:</span> <span class="n">u1_val</span><span class="p">,</span> <span class="n">U3</span><span class="p">:</span> <span class="n">u3_val</span><span class="p">})</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>

<span class="c1"># sigma3</span>
<span class="k">def</span> <span class="nf">sigma3App3</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">symbolic_expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sigmaApp3</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">),</span> <span class="n">U3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbolic_expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">U1</span><span class="p">:</span> <span class="n">u1_val</span><span class="p">,</span> <span class="n">U3</span><span class="p">:</span> <span class="n">u3_val</span><span class="p">})</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>

<span class="c1"># sigma33</span>
<span class="k">def</span> <span class="nf">sigma33App3</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">symbolic_expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sigmaApp3</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">),</span> <span class="n">U3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbolic_expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">U1</span><span class="p">:</span> <span class="n">u1_val</span><span class="p">,</span> <span class="n">U3</span><span class="p">:</span> <span class="n">u3_val</span><span class="p">})</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>

<span class="c1"># Fourth App formula</span>
<span class="c1"># sigma1</span>
<span class="k">def</span> <span class="nf">sigma1App4</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">symbolic_expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sigmaApp4</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">),</span> <span class="n">U1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbolic_expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">U1</span><span class="p">:</span> <span class="n">u1_val</span><span class="p">,</span> <span class="n">U3</span><span class="p">:</span> <span class="n">u3_val</span><span class="p">})</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>

<span class="c1"># sigma11</span>
<span class="k">def</span> <span class="nf">sigma11App4</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">symbolic_expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sigmaApp4</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">),</span> <span class="n">U1</span><span class="p">,</span><span class="n">U3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbolic_expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">U1</span><span class="p">:</span> <span class="n">u1_val</span><span class="p">,</span> <span class="n">U3</span><span class="p">:</span> <span class="n">u3_val</span><span class="p">})</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>

<span class="c1"># sigma13</span>
<span class="k">def</span> <span class="nf">sigma13App4</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">symbolic_expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sigmaApp4</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">),</span> <span class="n">U1</span><span class="p">,</span><span class="n">U3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbolic_expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">U1</span><span class="p">:</span> <span class="n">u1_val</span><span class="p">,</span> <span class="n">U3</span><span class="p">:</span> <span class="n">u3_val</span><span class="p">})</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>

<span class="c1"># sigma3</span>
<span class="k">def</span> <span class="nf">sigma3App4</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">symbolic_expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sigmaApp4</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">),</span> <span class="n">U3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbolic_expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">U1</span><span class="p">:</span> <span class="n">u1_val</span><span class="p">,</span> <span class="n">U3</span><span class="p">:</span> <span class="n">u3_val</span><span class="p">})</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>

<span class="c1"># sigma33</span>
<span class="k">def</span> <span class="nf">sigma33App4</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">symbolic_expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sigmaApp4</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U3</span><span class="p">),</span> <span class="n">U3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbolic_expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">U1</span><span class="p">:</span> <span class="n">u1_val</span><span class="p">,</span> <span class="n">U3</span><span class="p">:</span> <span class="n">u3_val</span><span class="p">})</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Test</span>

<span class="n">u1</span> <span class="o">=</span> <span class="mf">0.000015</span>
<span class="n">u3</span> <span class="o">=</span> <span class="mf">0.000023</span>
<span class="n">k1</span> <span class="o">=</span> <span class="mf">0.0000071</span>
<span class="n">k3</span> <span class="o">=</span> <span class="mf">0.0000091</span>

<span class="n">t1s</span> <span class="o">=</span> <span class="n">Tsigma1</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">Tsigma1</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>
<span class="n">t1A1</span> <span class="o">=</span> <span class="n">sigma1App1</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">sigma1App1</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>
<span class="n">t1A2</span> <span class="o">=</span> <span class="n">sigma1App2</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">sigma1App2</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>
<span class="n">t1A3</span> <span class="o">=</span> <span class="n">sigma1App3</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">sigma1App3</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>
<span class="n">t1A4</span> <span class="o">=</span> <span class="n">sigma1App4</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">sigma1App4</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>

<span class="n">t3s</span> <span class="o">=</span> <span class="n">Tsigma3</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">Tsigma3</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>
<span class="n">t3A1</span> <span class="o">=</span> <span class="n">sigma3App1</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">sigma3App1</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>
<span class="n">t3A2</span> <span class="o">=</span> <span class="n">sigma3App2</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">sigma3App2</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>
<span class="n">t3A3</span> <span class="o">=</span> <span class="n">sigma3App3</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">sigma3App3</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>
<span class="n">t3A4</span> <span class="o">=</span> <span class="n">sigma3App4</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">sigma3App4</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>

<span class="n">t13s</span> <span class="o">=</span> <span class="n">Tsigma13</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">Tsigma13</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>
<span class="n">t13A1</span> <span class="o">=</span> <span class="n">sigma13App1</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">sigma13App1</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>
<span class="n">t13A2</span> <span class="o">=</span> <span class="n">sigma13App2</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">sigma13App2</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>
<span class="n">t13A3</span> <span class="o">=</span> <span class="n">sigma13App3</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">sigma13App3</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>
<span class="n">t13A4</span> <span class="o">=</span> <span class="n">sigma13App4</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">sigma13App4</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>

<span class="n">t11s</span> <span class="o">=</span> <span class="n">Tsigma11</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">Tsigma11</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>
<span class="n">t11A1</span> <span class="o">=</span> <span class="n">sigma11App1</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">sigma11App1</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>
<span class="n">t11A2</span> <span class="o">=</span> <span class="n">sigma11App2</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">sigma11App2</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>
<span class="n">t11A3</span> <span class="o">=</span> <span class="n">sigma11App3</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">sigma11App3</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>
<span class="n">t11A4</span> <span class="o">=</span> <span class="n">sigma11App4</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">sigma11App4</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>

<span class="n">t33s</span> <span class="o">=</span> <span class="n">Tsigma33</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">Tsigma33</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>
<span class="n">t33A1</span> <span class="o">=</span> <span class="n">sigma33App1</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">sigma33App1</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>
<span class="n">t33A2</span> <span class="o">=</span> <span class="n">sigma33App2</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">sigma33App2</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>
<span class="n">t33A3</span> <span class="o">=</span> <span class="n">sigma33App3</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">sigma33App3</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>
<span class="n">t33A4</span> <span class="o">=</span> <span class="n">sigma33App4</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">/</span><span class="n">sigma33App4</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span><span class="n">k3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Comparison of the derivative values for small (u1,u3) with the values of approximate definitions&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sigma_1(u):&quot;</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-Approx 1:&quot;</span><span class="p">,</span> <span class="n">t1s</span><span class="o">-</span><span class="n">t1A1</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-Approx 2:&quot;</span><span class="p">,</span> <span class="n">t1s</span><span class="o">-</span><span class="n">t1A2</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-Approx 3:&quot;</span><span class="p">,</span> <span class="n">t1s</span><span class="o">-</span><span class="n">t1A3</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-Approx 4:&quot;</span><span class="p">,</span> <span class="n">t1s</span><span class="o">-</span><span class="n">t1A4</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sigma_3(u):&quot;</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-Approx 1:&quot;</span><span class="p">,</span> <span class="n">t3s</span><span class="o">-</span><span class="n">t3A1</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-Approx 2:&quot;</span><span class="p">,</span> <span class="n">t3s</span><span class="o">-</span><span class="n">t3A2</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-Approx 3:&quot;</span><span class="p">,</span> <span class="n">t3s</span><span class="o">-</span><span class="n">t3A3</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-Approx 4:&quot;</span><span class="p">,</span> <span class="n">t3s</span><span class="o">-</span><span class="n">t3A4</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sigma_13(u):&quot;</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-Approx 1:&quot;</span><span class="p">,</span> <span class="n">t13s</span><span class="o">-</span><span class="n">t13A1</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-Approx 2:&quot;</span><span class="p">,</span> <span class="n">t13s</span><span class="o">-</span><span class="n">t13A2</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-Approx 3:&quot;</span><span class="p">,</span> <span class="n">t13s</span><span class="o">-</span><span class="n">t13A3</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-Approx 4:&quot;</span><span class="p">,</span> <span class="n">t13s</span><span class="o">-</span><span class="n">t13A4</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sigma_11(u):&quot;</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-Approx 1:&quot;</span><span class="p">,</span> <span class="n">t11s</span><span class="o">-</span><span class="n">t11A1</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-Approx 2:&quot;</span><span class="p">,</span> <span class="n">t11s</span><span class="o">-</span><span class="n">t11A2</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-Approx 3:&quot;</span><span class="p">,</span> <span class="n">t11s</span><span class="o">-</span><span class="n">t11A3</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-Approx 4:&quot;</span><span class="p">,</span> <span class="n">t11s</span><span class="o">-</span><span class="n">t11A4</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sigma_33(u):&quot;</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-Approx 1:&quot;</span><span class="p">,</span> <span class="n">t33s</span><span class="o">-</span><span class="n">t33A1</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-Approx 2:&quot;</span><span class="p">,</span> <span class="n">t33s</span><span class="o">-</span><span class="n">t33A2</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-Approx 3:&quot;</span><span class="p">,</span> <span class="n">t33s</span><span class="o">-</span><span class="n">t33A3</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-Approx 4:&quot;</span><span class="p">,</span> <span class="n">t33s</span><span class="o">-</span><span class="n">t33A4</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Comparison of the derivative values for small (u1,u3) with the values of approximate definitions

Sigma_1(u):
-Approx 1: -3.46340016028878 + 1.51068251241782e-8*I
-Approx 2: -3.46340016028878 + 1.51068251241782e-8*I
-Approx 3: -1.04672448486554e-9 + 1.51068251241782e-8*I
-Approx 4: -1.04672448486554e-9 + 1.51068251241782e-8*I

Sigma_3(u):
-Approx 1: 2.50665199708067e-9
-Approx 2: 2.50665199708067e-9
-Approx 3: -5.38811737442093
-Approx 4: -5.38811737442093

Sigma_13(u):
-Approx 1: -12.2140980778502 + 0.232711163457174*I
-Approx 2: -12.2140980781028 + 0.232711163457174*I
-Approx 3: NaN + 0.232711163457174*I
-Approx 4: NaN + 0.232711163457174*I

Sigma_11(u):
-Approx 1: 0.287763214450281 + 0.00702792297612786*I
-Approx 2: 0.287763214450281 + 0.00702792297612786*I
-Approx 3: 0.287763220679852 + 0.00702792297612786*I
-Approx 4: NaN + 0.00702792297612786*I

Sigma_33(u):
-Approx 1: -0.249906823826918 - 9.18798370719287e-12*I
-Approx 2: -0.249906823826918 - 9.18798370719287e-12*I
-Approx 3: -0.249906847998870 - 9.18798370719287e-12*I
-Approx 4: -0.249906847998870 - 9.18798370719287e-12*I
</pre></div>
</div>
</div>
</div>
<div class="proof observation admonition" id="observation-1">
<p class="admonition-title"><span class="caption-number">Observation 3.2 </span></p>
<section class="observation-content" id="proof-content">
<p>This approximation of the sigma function value for small values needs to be cleaned up</p>
</section>
</div></section>
</section>
</section>
<section id="wp-functions">
<h2><span class="section-number">3.8. </span><span class="math notranslate nohighlight">\(\wp\)</span>-Functions<a class="headerlink" href="#wp-functions" title="Link to this heading">#</a></h2>
<p><a class="reference internal" href="2.%20Genus%3D2.html#wp_df">Definition 2.8</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definition with sigmas</span>


<span class="c1"># WeierstrassP11</span>
<span class="k">def</span> <span class="nf">WeierstrassP11</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">sigma_expr</span> <span class="o">=</span> <span class="n">Tsigma</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">)</span>
    <span class="n">sigma1</span> <span class="o">=</span> <span class="n">Tsigma1</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">)</span>
    <span class="n">sigma11</span> <span class="o">=</span> <span class="n">Tsigma11</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">)</span>
    <span class="n">expr</span> <span class="o">=</span> <span class="p">(</span><span class="n">sigma1</span><span class="o">*</span><span class="n">sigma1</span> <span class="o">-</span> <span class="n">sigma_expr</span><span class="o">*</span><span class="n">sigma11</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">sigma_expr</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>

<span class="c1"># WeierstrassP13</span>
<span class="k">def</span> <span class="nf">WeierstrassP13</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">sigma_expr</span> <span class="o">=</span> <span class="n">Tsigma</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">)</span>
    <span class="n">sigma1</span> <span class="o">=</span> <span class="n">Tsigma1</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">)</span>
    <span class="n">sigma3</span> <span class="o">=</span> <span class="n">Tsigma3</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">)</span>
    <span class="n">sigma13</span> <span class="o">=</span> <span class="n">Tsigma13</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">)</span>
    <span class="n">expr</span> <span class="o">=</span> <span class="p">(</span><span class="n">sigma1</span><span class="o">*</span><span class="n">sigma3</span> <span class="o">-</span> <span class="n">sigma_expr</span><span class="o">*</span><span class="n">sigma13</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">sigma_expr</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>
    
<span class="c1"># WeierstrassP33</span>
<span class="k">def</span> <span class="nf">WeierstrassP33</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">sigma_expr</span> <span class="o">=</span> <span class="n">Tsigma</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">)</span>
    <span class="n">sigma3</span> <span class="o">=</span> <span class="n">Tsigma3</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">)</span>
    <span class="n">sigma33</span> <span class="o">=</span> <span class="n">Tsigma33</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">)</span>
    <span class="n">expr</span> <span class="o">=</span> <span class="p">(</span><span class="n">sigma3</span><span class="o">*</span><span class="n">sigma3</span> <span class="o">-</span> <span class="n">sigma_expr</span><span class="o">*</span><span class="n">sigma33</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">sigma_expr</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>    

<span class="c1"># WeierstrassP3333</span>
<span class="k">def</span> <span class="nf">WeierstrassP3333</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">):</span>
    <span class="n">Sigma</span> <span class="o">=</span> <span class="n">Tsigma</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">)</span>
    <span class="n">Sigma3</span> <span class="o">=</span> <span class="n">Tsigma3</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">)</span>
    <span class="n">Sigma33</span> <span class="o">=</span> <span class="n">Tsigma33</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">)</span>
    <span class="n">Sigma333</span> <span class="o">=</span> <span class="n">Tsigma333</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">)</span>
    <span class="n">Sigma3333</span> <span class="o">=</span> <span class="n">Tsigma3333</span><span class="p">(</span><span class="n">u1_val</span><span class="p">,</span> <span class="n">u3_val</span><span class="p">)</span>
    <span class="n">expr</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="o">*</span> <span class="n">Sigma3</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">12</span> <span class="o">*</span> <span class="n">Sigma</span> <span class="o">*</span> <span class="n">Sigma3</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Sigma33</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">Sigma</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Sigma33</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">Sigma</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Sigma3</span> <span class="o">*</span> <span class="n">Sigma333</span> <span class="o">-</span> <span class="n">Sigma</span><span class="o">^</span><span class="mi">3</span> <span class="o">*</span> <span class="n">Sigma3333</span> <span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Sigma</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>   
</pre></div>
</div>
</div>
</div>
<section id="id4">
<h3><span class="section-number">3.8.1. </span>Tests<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ntest</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">nPtest</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">])</span>

<span class="n">wn</span> <span class="o">=</span> <span class="n">omega</span><span class="o">*</span><span class="n">ntest</span>
<span class="n">wPn</span><span class="o">=</span> <span class="n">omegaP</span><span class="o">*</span><span class="n">nPtest</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sigma based definitions&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test P11:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">WeierstrassP11</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">WeierstrassP11</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">3.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test P13:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">WeierstrassP13</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">WeierstrassP13</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">3.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test P33:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">WeierstrassP33</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">WeierstrassP33</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">3.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sigma based definitions

Test P11:
-3.78364006792253e-13 + 1.63424829224823e-13*I

Test P13:
-3.94351218346856e-13 + 4.47641923528863e-13*I

Test P33:
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-5.98632254877884e-13 + 2.10498285468930e-13*I
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ntest</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">])</span>
<span class="n">nPtest</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">])</span>

<span class="n">wn</span> <span class="o">=</span> <span class="n">omega</span><span class="o">*</span><span class="n">ntest</span>
<span class="n">wPn</span><span class="o">=</span> <span class="n">omegaP</span><span class="o">*</span><span class="n">nPtest</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sigma based definitions&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test P11:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">WeierstrassP11</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">WeierstrassP11</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">3.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test P13:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">WeierstrassP13</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">WeierstrassP13</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">3.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test P33:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">WeierstrassP33</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">WeierstrassP33</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">3.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sigma based definitions

Test P11:
5.59552404411079e-13 - 5.86197757002083e-13*I

Test P13:
-1.90070181815827e-13 - 2.92210700081341e-13*I

Test P33:
-3.37507799486048e-14 - 6.22446538756094e-13*I
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ntest</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">nPtest</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">])</span>

<span class="n">wn</span> <span class="o">=</span> <span class="n">omega</span><span class="o">*</span><span class="n">ntest</span>
<span class="n">wPn</span><span class="o">=</span> <span class="n">omegaP</span><span class="o">*</span><span class="n">nPtest</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sigma based definitions&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test P11:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">WeierstrassP11</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">WeierstrassP11</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">3.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test P13:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">WeierstrassP13</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">WeierstrassP13</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">3.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test P33:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">WeierstrassP33</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">WeierstrassP33</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">3.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sigma based definitions

Test P11:
2.36255459640233e-13 + 3.83693077310454e-13*I

Test P13:
3.14415160573844e-13 + 3.23296944770846e-13*I

Test P33:
3.32178728967847e-13 - 9.68114477473137e-14*I
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ntest</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">])</span>
<span class="n">nPtest</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">])</span>

<span class="n">wn</span> <span class="o">=</span> <span class="n">omega</span><span class="o">*</span><span class="n">ntest</span>
<span class="n">wPn</span><span class="o">=</span> <span class="n">omegaP</span><span class="o">*</span><span class="n">nPtest</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sigma based definitions&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test P11:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">WeierstrassP11</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">WeierstrassP11</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">3.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test P13:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">WeierstrassP13</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">WeierstrassP13</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">3.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test P33:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">WeierstrassP33</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">WeierstrassP33</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">3.0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">wPn</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sigma based definitions

Test P11:
-5.11590769747272e-12 + 9.34363697524532e-13*I

Test P13:
-6.19237994214927e-12 + 1.63247193540883e-12*I

Test P33:
-2.16093809513040e-11 - 3.40456551839452e-11*I
</pre></div>
</div>
</div>
</div>
<div class="proof observation admonition" id="observation-2">
<p class="admonition-title"><span class="caption-number">Observation 3.3 </span></p>
<section class="observation-content" id="proof-content">
<p>Thanks to the RiemannTheata package, there is no problem with large period repetitions and the calculations are performed much faster</p>
</section>
</div></section>
<section id="basic-relations">
<h3><span class="section-number">3.8.2. </span>Basic relations<a class="headerlink" href="#basic-relations" title="Link to this heading">#</a></h3>
<section id="i">
<h4><span class="section-number">3.8.2.1. </span>I.<a class="headerlink" href="#i" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="2.%20Genus%3D2.html#wp3333">Definition 2.9</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u1</span> <span class="o">=</span> <span class="mf">0.212131</span>
<span class="n">u3</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.231</span>

<span class="n">RHS</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">WeierstrassP33</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">l2</span> <span class="o">*</span> <span class="n">WeierstrassP33</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span> <span class="o">+</span> <span class="n">l0</span> <span class="o">*</span> <span class="n">WeierstrassP13</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="n">l4</span><span class="o">*</span><span class="n">l0</span>
<span class="n">RHS</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>171.497502935101 - 3.81020381888539*I
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span> <span class="n">WeierstrassP3333</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>507.268789007104 - 1.36424205265939e-12*I
</pre></div>
</div>
</div>
</div>
</section>
<section id="ii">
<h4><span class="section-number">3.8.2.2. </span>II.<a class="headerlink" href="#ii" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="2.%20Genus%3D2.html#addition_formula">Definition 2.10</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u1</span> <span class="o">=</span> <span class="mf">1.2131</span>
<span class="n">u3</span> <span class="o">=</span> <span class="mf">7.231</span>
<span class="n">v1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.32131</span>
<span class="n">v3</span> <span class="o">=</span> <span class="mf">9.1231</span>

<span class="n">LHS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Tsigma</span><span class="p">(</span><span class="n">u1</span><span class="o">+</span><span class="n">v1</span><span class="p">,</span> <span class="n">u3</span><span class="o">+</span><span class="n">v3</span><span class="p">)</span> <span class="o">*</span> <span class="n">Tsigma</span><span class="p">(</span><span class="n">u1</span><span class="o">-</span><span class="n">v1</span><span class="p">,</span> <span class="n">u3</span><span class="o">-</span><span class="n">v3</span><span class="p">))</span><span class="o">/</span> <span class="p">(</span><span class="n">Tsigma</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span> <span class="n">u3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Tsigma</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>

<span class="n">RHS</span> <span class="o">=</span> <span class="n">WeierstrassP33</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span> <span class="o">*</span> <span class="n">WeierstrassP13</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v3</span><span class="p">)</span> <span class="o">-</span> <span class="n">WeierstrassP13</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span> <span class="o">*</span> <span class="n">WeierstrassP33</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v3</span><span class="p">)</span> <span class="o">-</span> <span class="n">WeierstrassP11</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span> <span class="o">+</span> <span class="n">WeierstrassP11</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;LHS:&quot;</span><span class="p">,</span> <span class="n">LHS</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RHS:&quot;</span><span class="p">,</span> <span class="n">RHS</span><span class="p">)</span>
<span class="c1">#the square root of a fraction should be equal to the constant C from the definition of the Sigma function</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;C constant:&quot;</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">RHS</span><span class="o">/</span><span class="n">LHS</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LHS: -0.0390350065536316 - 0.0934967676081618*I
RHS: -6.79063037934265 + 4.33713413558659*I
C constant: 5.73786598022205 - 6.82668500216628*I
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u1</span> <span class="o">=</span> <span class="mf">0.212131</span>
<span class="n">u3</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.231</span>
<span class="n">v1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.41232131</span>
<span class="n">v3</span> <span class="o">=</span> <span class="mf">4.1231</span>

<span class="n">LHS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Tsigma</span><span class="p">(</span><span class="n">u1</span><span class="o">+</span><span class="n">v1</span><span class="p">,</span> <span class="n">u3</span><span class="o">+</span><span class="n">v3</span><span class="p">)</span> <span class="o">*</span> <span class="n">Tsigma</span><span class="p">(</span><span class="n">u1</span><span class="o">-</span><span class="n">v1</span><span class="p">,</span> <span class="n">u3</span><span class="o">-</span><span class="n">v3</span><span class="p">))</span><span class="o">/</span> <span class="p">(</span><span class="n">Tsigma</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span> <span class="n">u3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Tsigma</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>

<span class="n">RHS</span> <span class="o">=</span> <span class="n">WeierstrassP33</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span> <span class="o">*</span> <span class="n">WeierstrassP13</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v3</span><span class="p">)</span> <span class="o">-</span> <span class="n">WeierstrassP13</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span> <span class="o">*</span> <span class="n">WeierstrassP33</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v3</span><span class="p">)</span> <span class="o">-</span> <span class="n">WeierstrassP11</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u3</span><span class="p">)</span> <span class="o">+</span> <span class="n">WeierstrassP11</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;LHS:&quot;</span><span class="p">,</span> <span class="n">LHS</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RHS:&quot;</span><span class="p">,</span> <span class="n">RHS</span><span class="p">)</span>
<span class="c1">#the square root of a fraction should be equal to the constant C from the definition of the Sigma function</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;C constant:&quot;</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">RHS</span><span class="o">/</span><span class="n">LHS</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LHS: 0.526427255076736 + 1.26090017848212*I
RHS: 11.3163279420617 - 0.863053328652273*I
C constant: 2.33601808483570 - 1.68791189834995*I
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="jacobi-inversion-problem-on-branch-points">
<h2><span class="section-number">3.9. </span>Jacobi inversion problem on branch points<a class="headerlink" href="#jacobi-inversion-problem-on-branch-points" title="Link to this heading">#</a></h2>
<section id="divisor">
<h3><span class="section-number">3.9.1. </span>Divisor<a class="headerlink" href="#divisor" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definition of y function </span>
<span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">l0</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">l2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">l4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">l6</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">l8</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">l10</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="mf">0.256</span>
<span class="n">x2</span> <span class="o">=</span> <span class="mf">11.721</span>

<span class="n">y1</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>

<span class="c1"># P_i points</span>
<span class="n">P1</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="p">]</span> 
<span class="n">P2</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="p">]</span>

<span class="c1"># Divisor</span>
<span class="n">divisor</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">))]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">AJ</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">abel_jacobi</span><span class="p">(</span><span class="n">divisor</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">AJ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.095227328487916328568064649224 - 0.47103938123276306779408678278*I, -0.94610300133296732955826058561 - 0.36651365565790567383047992719*I)
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h3><span class="section-number">3.9.2. </span>Tests<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u1</span><span class="o">=</span><span class="n">AJ</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">u3</span><span class="o">=</span><span class="n">AJ</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;P11(u):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">WeierstrassP11</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span> <span class="n">u3</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;P13(u):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">WeierstrassP13</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span> <span class="n">u3</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;P33(u):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">WeierstrassP33</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span> <span class="n">u3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>P11(u):
9.90660612582494 + 15.7680152150508*I
P13(u):
-4.71550103486836 - 4.28713142229178*I
P33(u):
-6.10312233060515 + 3.64722933554347*I
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mat1R4</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">],[</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="p">]]</span>
<span class="n">det1</span><span class="o">=</span><span class="n">matrix</span><span class="p">(</span><span class="n">mat1R4</span><span class="p">)</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="n">mat2R4</span><span class="o">=</span><span class="p">[[</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">x2</span><span class="p">]]</span>
<span class="n">det2</span><span class="o">=</span><span class="n">matrix</span><span class="p">(</span><span class="n">mat2R4</span><span class="p">)</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="n">det1</span><span class="o">/</span><span class="n">det2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^2 - 11.9770000000000*x + 3.00057600000000
</pre></div>
</div>
</div>
</div>
<p>We should get:</p>
<div class="math notranslate nohighlight">
\[    x^2 - \wp_{11}(\mathbf{u}) \;x - \wp_{13}(\mathbf{u})=0,\]</div>
<div class="proof observation admonition" id="observation-3">
<p class="admonition-title"><span class="caption-number">Observation 3.4 </span></p>
<section class="observation-content" id="proof-content">
<p>Unfortunately the final result is still wrong.</p>
</section>
</div></section>
</section>
<section id="bibliography">
<h2><span class="section-number">3.10. </span>Bibliography<a class="headerlink" href="#bibliography" title="Link to this heading">#</a></h2>
<div class="docutils container" id="id6">
<div role="list" class="citation-list">
<div class="citation" id="id13" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Julia Bernatska. Computation of \$\wp\$-functions on plane algebraic curves. July 2024. URL: <a class="reference external" href="https://arxiv.org/abs/2407.05632v3">https://arxiv.org/abs/2407.05632v3</a> (visited on 2024-10-17).</p>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "sagemath-10.4"
        },
        kernelOptions: {
            name: "sagemath-10.4",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'sagemath-10.4'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="2.%20Genus%3D2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Genus 2 case</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#riemann-surface">3.1. Riemann surface</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#branch-points">3.2. Branch points</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#first-and-second-kind-periods">3.3. First and Second Kind Periods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#first-kind-periods">3.3.1. First  Kind Periods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#second-kind-periods">3.3.2. Second Kind Periods</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#legendre-relation">3.4. Legendre relation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#characteristics-of-branch-points">3.5. Characteristics of branch points</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#theta-function">3.6. Theta function</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tests">3.6.1. Tests</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sigma-functions">3.7. <span class="math notranslate nohighlight">\(\sigma\)</span>-Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#approximate-definitions">3.7.1. Approximate definitions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">3.7.2. Tests</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#derivatives">3.7.3. Derivatives</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">3.7.3.1. Tests</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wp-functions">3.8. <span class="math notranslate nohighlight">\(\wp\)</span>-Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">3.8.1. Tests</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-relations">3.8.2. Basic relations</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#i">3.8.2.1. I.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ii">3.8.2.2. II.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jacobi-inversion-problem-on-branch-points">3.9. Jacobi inversion problem on branch points</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#divisor">3.9.1. Divisor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">3.9.2. Tests</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bibliography">3.10. Bibliography</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>